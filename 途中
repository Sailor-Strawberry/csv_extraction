@echo off

setlocal enabledelayedexpansion

REM 入力ファイルのパスと名前を指定してください

set "input_file=path\to\input.csv"

REM 出力ファイルのパスと名前を指定してください

set "output_file=path\to\output.csv"

REM 抽出開始行と抽出間隔を指定してください（1から始まる行番号）

set "start_row=300"

set "interval=10"

REM ヘッダー行を抽出するため、ヘッダーの行数を指定してください

set "header_rows=4"  REM 例: ヘッダー行が4行ある場合は4に設定してください

REM ヘッダー行数を加味した抽出開始行を計算します

set /a "adjusted_start_row=start_row + header_rows"

REM 抽出処理を開始します

echo Extracting rows from %input_file%...

echo.

REM ヘッダー行の抽出処理を開始します

set /a "counter=0"

for /f "usebackq delims=" %%a in ("%input_file%") do (

    set /a "counter+=1"

    if !counter! leq %header_rows% (

        echo %%a

    )

    if !counter! equ %header_rows% (

        goto :DataExtraction

    )

)

:DataExtraction

REM データ行の抽出処理を開始します

set /a "counter=0"

for /f "usebackq skip=%adjusted_start_row% tokens=*" %%a in ("%input_file%") do (

    set /a "counter+=1"

    set /a "current_row=start_row + (counter-1) * interval"

    if !current_row! geq %start_row% (

        set /a "remainder=!counter! %% !interval!"

        if !remainder! equ 0 (

            echo %%a

        )

    )

) >> "%output_file%"

REM 抽出処理が完了しました

echo.

echo Extraction completed. Extracted rows are saved in %output_file%.

echo.

echo Press any key to exit.

pause > nul

