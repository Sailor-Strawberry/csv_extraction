@echo off

setlocal enabledelayedexpansion

REM 入力ファイルのパスと名前を指定してください

set "input_file=path\to\input.csv"

REM 出力ファイルのパスと名前を指定してください

set "output_file=path\to\output.csv"

REM 抽出開始行と抽出間隔を指定してください（1から始まる行番号）

set "start_row=300"

set "interval=10"

REM 抽出するヘッダーの数を指定してください

set "header_count=2"

REM ヘッダーの行数を指定してください（ヘッダー行数が2行以上ある場合は増やしてください）

set "header_rows=2"

REM ヘッダー行数を加味した抽出開始行を計算します

set /a "adjusted_start_row=start_row + header_rows"

REM 抽出処理を開始します

echo Extracting rows from %input_file%...

echo.

REM 一時ファイルにヘッダー行を書き込みます

(

    for /l %%i in (1,1,%header_count%) do (

        set "header_line="

        for /f "usebackq skip=%%i delims=" %%h in ("%input_file%") do (

            set "header_line=%%h"

            goto :break

        )

        :break

        echo !header_line!

    )

) > "%output_file%"

REM データ行の抽出処理を開始します

(

    set /a "counter=0"

    for /f "usebackq skip=%adjusted_start_row% tokens=*" %%a in ("%input_file%") do (

        set /a "counter+=1"

        set /a "remainder=!counter! %% !interval!"

        if !remainder! equ 0 (

            echo %%a

        )

    )

) >> "%output_file%"

REM 抽出処理が完了しました

echo.

echo Extraction completed. Extracted rows are saved in %output_file%.

echo.

echo Press any key to exit.

pause > nul

